{"id":"imagen-0dh","title":"Skip clippy --fix on pre-satisfied no-modification sessions","description":"Running clippy --fix when no files were modified is wasteful. Saves 1-2 turns on trivial sessions.","design":"Edit PROMPT.md: In step 4b (Code quality gates), add: If zero files were modified this session (pre-satisfied path), skip cargo clippy --fix --allow-dirty. Run only: cargo test --release and cargo fmt --check.","status":"open","priority":1,"issue_type":"task","owner":"shout@ozten.com","created_at":"2026-02-24T19:01:07.114848847Z","created_by":"Austin King","updated_at":"2026-02-24T19:01:07.114848847Z"}
{"id":"imagen-1fs","title":"Create release.sh version bump and tag script","description":"Create scripts/release.sh adapted from ../blacksmith/scripts/release.sh. Changes from blacksmith:\n- Single Cargo.toml (no workspace member)\n- sed updates version in Cargo.toml, runs cargo check, commits + tags\n\nKeep from blacksmith: semver validation, clean tree check, tag creation.\n\nUsage: ./scripts/release.sh 0.1.0 \u0026\u0026 git push origin main v0.1.0\n\n## Acceptance Criteria\n- [ ] scripts/release.sh exists and is executable\n- [ ] Script validates semver format (e.g., 0.1.0)\n- [ ] Script checks for clean git tree (no uncommitted changes)\n- [ ] Script updates version in Cargo.toml via sed\n- [ ] Script runs cargo check to verify the version bump compiles\n- [ ] Script creates a git commit and tag (v0.1.0)\n- [ ] cargo check passes with no new errors\n- [ ] cargo test passes (all existing tests)\n\n## Verify\n- Run: bash -n scripts/release.sh\n- Expect: No syntax errors\n\n## Affected files\n- scripts/release.sh (new — adapted from ../blacksmith/scripts/release.sh)","status":"open","priority":2,"issue_type":"task","owner":"shout@ozten.com","created_at":"2026-02-24T18:41:26.15540208Z","created_by":"Austin King","updated_at":"2026-02-24T18:46:39.011441183Z","dependencies":[{"issue_id":"imagen-1fs","depends_on_id":"imagen-jdc","type":"blocks","created_at":"2026-02-24T18:43:58.069299716Z","created_by":"Austin King"}]}
{"id":"imagen-1xm","title":"Wire replaying adapter to serve responses from cassettes","description":"Wire the replaying adapter so that when IMAGEN_REPLAY=\u003cpath\u003e is set, API calls are served from a pre-recorded cassette YAML file instead of hitting any live API. The scaffolding exists at src/adapters/replaying/image_generator.rs and src/cassette/replayer.rs. This bead connects them so replay serves deterministic responses. ServiceContext::replaying() should load the cassette and create a ReplayingImageGenerator.\n\n## Acceptance Criteria\n- [ ] ReplayingImageGenerator loads a cassette YAML and serves responses in recorded order\n- [ ] ServiceContext::replaying(path) constructs a ReplayingImageGenerator from cassette file\n- [ ] IMAGEN_REPLAY=\u003ccassette.yaml\u003e cargo run -- \"a cat\" produces identical output to the original recording\n- [ ] Exhausted cassette (more calls than recorded) returns a clear error\n- [ ] No network calls are made during replay\n- [ ] cargo check passes with no new errors\n- [ ] cargo test passes (all existing tests)\n\n## Verify\n- Run: IMAGEN_REPLAY=test_fixtures/gemini_cat.cassette.yaml cargo run -- \"a cat\"\n- Expect: Image saved identically to original recording, no network activity\n\n## Affected files\n- src/adapters/replaying/image_generator.rs (modified)\n- src/context.rs (modified)\n- src/cassette/replayer.rs (modified — if adjustments needed)","status":"closed","priority":1,"issue_type":"feature","owner":"shout@ozten.com","created_at":"2026-02-24T18:41:09.734203314Z","created_by":"Austin King","updated_at":"2026-02-24T18:58:42.178222794Z","closed_at":"2026-02-24T18:58:42.178222794Z","close_reason":"single-agent direct commit","dependencies":[{"issue_id":"imagen-1xm","depends_on_id":"imagen-vux","type":"blocks","created_at":"2026-02-24T18:43:57.891113874Z","created_by":"Austin King"}]}
{"id":"imagen-3v0","title":"Create GitHub Actions CI and release workflows","description":"Create GitHub Actions workflows adapted from ../blacksmith/.github/workflows/:\n\n1. .github/workflows/release.yml (from ../blacksmith/.github/workflows/release.yml):\n   - 4-platform matrix: linux amd64/arm64, darwin amd64/arm64\n   - cross for linux ARM64\n   - Single binary package (imagen only, no workspace)\n   - SHA256 checksums + softprops/action-gh-release@v2\n   - latest tag update\n   - Archive format: imagen_{version}_{platform}.tar.gz\n\n2. .github/workflows/ci.yml (new):\n   - cargo fmt --all -- --check\n   - cargo clippy --all-targets --all-features -- -D warnings\n   - cargo test --all-targets --all-features\n   - Triggered on push to main and PRs\n\n## Acceptance Criteria\n- [ ] .github/workflows/release.yml exists with 4-platform matrix build\n- [ ] .github/workflows/ci.yml exists with fmt + clippy + test jobs\n- [ ] Release workflow triggers on tag push (v*)\n- [ ] CI workflow triggers on push to main and pull requests\n- [ ] YAML syntax is valid\n- [ ] cargo check passes with no new errors\n- [ ] cargo test passes (all existing tests)\n\n## Verify\n- Run: python3 -c \"import yaml; yaml.safe_load(open('.github/workflows/ci.yml'))\" \u0026\u0026 python3 -c \"import yaml; yaml.safe_load(open('.github/workflows/release.yml'))\"\n- Expect: No YAML parse errors\n\n## Affected files\n- .github/workflows/release.yml (new — adapted from ../blacksmith/.github/workflows/release.yml)\n- .github/workflows/ci.yml (new)","status":"open","priority":2,"issue_type":"task","owner":"shout@ozten.com","created_at":"2026-02-24T18:41:29.523055383Z","created_by":"Austin King","updated_at":"2026-02-24T18:46:39.01223885Z","dependencies":[{"issue_id":"imagen-3v0","depends_on_id":"imagen-jdc","type":"blocks","created_at":"2026-02-24T18:43:58.090971935Z","created_by":"Austin King"}]}
{"id":"imagen-5h1","title":"Wire recording adapter to save cassettes during live calls","description":"Wire the recording adapter so that when IMAGEN_REC=true is set, API calls flow through RecordingImageGenerator which wraps a live adapter, forwards the call, and saves the request/response pair to a YAML cassette file. The scaffolding exists at src/adapters/recording/image_generator.rs and src/cassette/recorder.rs. This bead connects them so recording actually captures real interactions. ServiceContext::recording() should wrap the live adapter with the recording layer.\n\n## Acceptance Criteria\n- [ ] RecordingImageGenerator wraps a live adapter and forwards generate() calls\n- [ ] After each generate() call, the request and response are recorded via CassetteRecorder\n- [ ] ServiceContext::recording() constructs a RecordingImageGenerator wrapping the live adapter\n- [ ] IMAGEN_REC=true cargo run -- \"a cat\" produces a cassette YAML file in .imagen/cassettes/\n- [ ] The cassette YAML contains the full request and base64-encoded response\n- [ ] cargo check passes with no new errors\n- [ ] cargo test passes (all existing tests)\n\n## Verify\n- Run: IMAGEN_REC=true GEMINI_API_KEY=\u003ckey\u003e cargo run -- \"a cat\"\n- Expect: Image saved AND cassette YAML file created in .imagen/cassettes/\u003ctimestamp\u003e/\n\n## Affected files\n- src/adapters/recording/image_generator.rs (modified)\n- src/context.rs (modified)\n- src/cassette/recorder.rs (modified — if adjustments needed)","status":"open","priority":1,"issue_type":"feature","owner":"shout@ozten.com","created_at":"2026-02-24T18:41:06.837804636Z","created_by":"Austin King","updated_at":"2026-02-24T18:46:39.006954056Z","dependencies":[{"issue_id":"imagen-5h1","depends_on_id":"imagen-vux","type":"blocks","created_at":"2026-02-24T18:43:57.86805507Z","created_by":"Austin King"}]}
{"id":"imagen-6jy","title":"Record initial cassettes for Gemini and OpenAI","description":"MANUAL STEP requiring real API keys. The agentic harness must be stopped so the user can configure keys.\n\n1. Ensure Phases 1+2 produce a working imagen binary that can record\n2. touch STOP to stop the agentic harness\n3. User creates ~/.config/imagen/config.toml with API keys:\n   [keys]\n   gemini = \"your-gemini-api-key\"\n   openai = \"your-openai-api-key\"\n4. User records Gemini cassette: IMAGEN_REC=true cargo run -- \"a cat\"\n5. User records OpenAI cassette: IMAGEN_REC=true cargo run -- -m gpt-1 \"a cat\"\n6. Copy recorded cassettes to test_fixtures/:\n   - test_fixtures/gemini_cat.cassette.yaml\n   - test_fixtures/openai_cat.cassette.yaml\n\nAfter this step, all subsequent automated tests replay from these cassettes. No test ever hits a live API.\n\n## Acceptance Criteria\n- [ ] test_fixtures/gemini_cat.cassette.yaml exists with real recorded Gemini interaction\n- [ ] test_fixtures/openai_cat.cassette.yaml exists with real recorded OpenAI interaction\n- [ ] IMAGEN_REPLAY=test_fixtures/gemini_cat.cassette.yaml cargo run -- \"a cat\" replays successfully\n- [ ] IMAGEN_REPLAY=test_fixtures/openai_cat.cassette.yaml cargo run -- -m gpt-1 \"a cat\" replays successfully\n- [ ] cargo check passes with no new errors\n- [ ] cargo test passes (all existing tests)\n\n## Verify\n- Run: IMAGEN_REPLAY=test_fixtures/gemini_cat.cassette.yaml cargo run -- \"a cat\"\n- Expect: Image saved from cassette replay, no live API call\n\n## Affected files\n- test_fixtures/gemini_cat.cassette.yaml (new)\n- test_fixtures/openai_cat.cassette.yaml (new)","status":"open","priority":1,"issue_type":"task","owner":"shout@ozten.com","created_at":"2026-02-24T18:41:13.300344886Z","created_by":"Austin King","updated_at":"2026-02-24T18:46:39.008513099Z","dependencies":[{"issue_id":"imagen-6jy","depends_on_id":"imagen-5h1","type":"blocks","created_at":"2026-02-24T18:43:57.916055262Z","created_by":"Austin King"},{"issue_id":"imagen-6jy","depends_on_id":"imagen-1xm","type":"blocks","created_at":"2026-02-24T18:43:57.938925107Z","created_by":"Austin King"}]}
{"id":"imagen-6pe","title":"Add README and developer documentation","description":"Create README.md and developer documentation. README should include: install via curl, usage examples, model table, configuration, and links to detailed docs. Adapt install section pattern from ../blacksmith/README.md.\n\nDocumentation files:\n- docs/record-replay.md: How to record and replay cassette sessions (content outlined in PRD)\n- docs/development.md: Build, test, lint, coverage, CI instructions\n- docs/architecture.md: Hexagonal architecture overview with port/adapter diagram\n\n## Acceptance Criteria\n- [ ] README.md exists with install, usage, model table, config sections\n- [ ] Install section shows: curl -fsSL https://raw.githubusercontent.com/ozten/imagen/main/scripts/install.sh | bash\n- [ ] docs/record-replay.md documents recording and replaying sessions\n- [ ] docs/development.md documents build, test, lint, coverage commands\n- [ ] docs/architecture.md describes hexagonal architecture\n- [ ] cargo check passes with no new errors\n- [ ] cargo test passes (all existing tests)\n\n## Verify\n- Run: ls README.md docs/record-replay.md docs/development.md docs/architecture.md\n- Expect: All four files exist\n\n## Affected files\n- README.md (new)\n- docs/record-replay.md (new)\n- docs/development.md (new)\n- docs/architecture.md (new)","status":"open","priority":3,"issue_type":"task","owner":"shout@ozten.com","created_at":"2026-02-24T18:41:35.554942226Z","created_by":"Austin King","updated_at":"2026-02-24T18:46:39.015040809Z","dependencies":[{"issue_id":"imagen-6pe","depends_on_id":"imagen-sxh","type":"blocks","created_at":"2026-02-24T18:43:58.11553674Z","created_by":"Austin King"},{"issue_id":"imagen-6pe","depends_on_id":"imagen-lko","type":"blocks","created_at":"2026-02-24T18:43:58.14123317Z","created_by":"Austin King"},{"issue_id":"imagen-6pe","depends_on_id":"imagen-1fs","type":"blocks","created_at":"2026-02-24T18:43:58.168507892Z","created_by":"Austin King"},{"issue_id":"imagen-6pe","depends_on_id":"imagen-3v0","type":"blocks","created_at":"2026-02-24T18:43:58.191868362Z","created_by":"Austin King"}]}
{"id":"imagen-76j","title":"Batch parallel calls in verify step 4a","description":"Apply improvement R5: update PROMPT.md step 4a to require parallel Bash calls for independent verify commands","design":"Edit PROMPT.md: In step 4a (Bead-specific verification), after 'execute those exact steps', add: 'If the ## Verify section lists multiple independent commands (e.g. cargo test AND a curl check), emit all of them as parallel Bash calls in ONE turn per Rule A — do not run them sequentially.'","status":"open","priority":1,"issue_type":"task","owner":"shout@ozten.com","created_at":"2026-02-24T19:14:51.730550966Z","created_by":"Austin King","updated_at":"2026-02-24T19:14:51.730550966Z"}
{"id":"imagen-8ad","title":"Add code coverage with cargo-llvm-cov targeting 80%","description":"Set up code coverage measurement using cargo-llvm-cov. Target 80% coverage excluding main.rs and live adapters (src/adapters/live/). Add a script or Makefile target to run coverage. Ensure the CI workflow will be able to check coverage as a quality gate.\n\n## Acceptance Criteria\n- [ ] cargo llvm-cov runs and produces a coverage report\n- [ ] Coverage excludes main.rs and src/adapters/live/ (these require real API keys)\n- [ ] Coverage is \u003e= 80% on the included source files\n- [ ] A script or command documents how to run coverage (e.g., scripts/coverage.sh or Makefile target)\n- [ ] cargo check passes with no new errors\n- [ ] cargo test passes (all existing tests)\n\n## Verify\n- Run: cargo llvm-cov --ignore-filename-regex \"(main|adapters/live)\" -- --all-targets\n- Expect: Coverage report showing \u003e= 80% for included files\n\n## Affected files\n- scripts/coverage.sh (new) or Makefile (new)\n- Cargo.toml (modified — if dev-dependency needed)","status":"open","priority":2,"issue_type":"task","owner":"shout@ozten.com","created_at":"2026-02-24T18:41:19.817685594Z","created_by":"Austin King","updated_at":"2026-02-24T18:46:39.009925391Z","dependencies":[{"issue_id":"imagen-8ad","depends_on_id":"imagen-sxh","type":"blocks","created_at":"2026-02-24T18:43:57.988372216Z","created_by":"Austin King"}]}
{"id":"imagen-b7n","title":"Wire Gemini live adapter to make real API calls","description":"Complete the Gemini live adapter so it makes real API calls. The skeleton exists at src/adapters/live/gemini.rs with the struct and trait impl stubbed out. Wire it to POST to https://generativelanguage.googleapis.com/v1beta/models/{model}:generateContent with x-goog-api-key header auth. Parse candidates[].content.parts[].inline_data for base64 JPEG image data. Gemini always returns JPEG regardless of requested format. See PRD \"External References\" section for API details.\n\n## Acceptance Criteria\n- [ ] GeminiAdapter::generate() sends correct HTTP POST with JSON body containing prompt, aspect_ratio, and responseModalities: [\"IMAGE\"]\n- [ ] Response parsing extracts base64 image data from candidates[].content.parts[].inline_data\n- [ ] API key is read from Config::gemini_key() (env var \u003e config file)\n- [ ] Missing API key returns ImageError::MissingApiKey\n- [ ] HTTP errors return ImageError::Api with status code and message\n- [ ] cargo check passes with no new errors\n- [ ] cargo test passes (all existing tests)\n\n## Verify\n- Run: GEMINI_API_KEY=test cargo check\n- Expect: Compiles without errors. Manual live test: GEMINI_API_KEY=\u003creal-key\u003e cargo run -- \"a cat\"\n\n## Affected files\n- src/adapters/live/gemini.rs (modified)","status":"closed","priority":1,"issue_type":"feature","owner":"shout@ozten.com","created_at":"2026-02-24T18:40:55.935092782Z","created_by":"Austin King","updated_at":"2026-02-24T18:54:34.852058723Z","closed_at":"2026-02-24T18:54:34.852058723Z","close_reason":"single-agent direct commit","dependencies":[{"issue_id":"imagen-b7n","depends_on_id":"imagen-jdc","type":"blocks","created_at":"2026-02-24T18:43:57.769398102Z","created_by":"Austin King"}]}
{"id":"imagen-f9z","title":"Enforce ## Verify section on pre-satisfied beads","description":"Process improvement to prevent bead sessions that claim done without running verify section. Seen when imagen-1xm session 5 claimed satisfied but missed a test fixture requirement, requiring session 6 to fix.","design":"Edit PROMPT.md: In step 3 (Implement) add a CRITICAL note after 'Complete the task fully': If acceptance criteria appear already satisfied by prior work, skip to step 4 but run ALL Verify commands before recording progress. Never write a progress entry claiming done until verify section passes.","status":"open","priority":1,"issue_type":"task","owner":"shout@ozten.com","created_at":"2026-02-24T19:00:59.125568362Z","created_by":"Austin King","updated_at":"2026-02-24T19:00:59.125568362Z"}
{"id":"imagen-gzv","title":"Wire config defaults to override CLI defaults","description":"Wire config.defaults into main.rs so that config file default values override CLI defaults when the user hasn't explicitly set a flag. Currently DefaultsConfig fields have #[allow(dead_code)] annotations. Remove those and use config.defaults to set effective values for model, aspect_ratio, size, quality, and format when the CLI arg matches its default (meaning the user didn't override it).\n\n## Acceptance Criteria\n- [ ] Config file [defaults] section values are used when CLI flags are at their defaults\n- [ ] Explicit CLI flags always override config defaults\n- [ ] #[allow(dead_code)] removed from DefaultsConfig and its fields\n- [ ] Unit test: config default model overrides CLI default \"nano-banana\"\n- [ ] Unit test: explicit -m flag overrides config default\n- [ ] cargo check passes with no new errors\n- [ ] cargo test passes (all existing + new tests)\n\n## Verify\n- Run: Create a config.toml with [defaults] model = \"gpt-1\", then cargo run -- \"test\" should use gpt-1\n- Expect: Verbose output shows model resolved from config default\n\n## Affected files\n- src/main.rs (modified)\n- src/config.rs (modified — remove dead_code allows)","status":"open","priority":2,"issue_type":"feature","owner":"shout@ozten.com","created_at":"2026-02-24T18:41:32.434120109Z","created_by":"Austin King","updated_at":"2026-02-24T18:46:39.012917892Z","dependencies":[{"issue_id":"imagen-gzv","depends_on_id":"imagen-jdc","type":"blocks","created_at":"2026-02-24T18:43:58.012187478Z","created_by":"Austin King"}]}
{"id":"imagen-jdc","title":"Initialize git repository and create initial commit","description":"Initialize a git repository for the imagen project at ~/imagen/. All Phase 1 scaffold code already exists and compiles. This bead creates the repo, adds a .gitignore, and makes the initial commit.\n\n## Acceptance Criteria\n- [ ] ~/imagen/ is a git repository\n- [ ] .gitignore excludes target/, *.swp, .env, and IDE files\n- [ ] Initial commit contains all Phase 1 source files\n- [ ] cargo build succeeds from a clean checkout\n- [ ] cargo test passes (51 existing tests)\n\n## Verify\n- Run: cd ~/imagen \u0026\u0026 git log --oneline -1\n- Expect: Initial commit with all Phase 1 scaffold files\n\n## Affected files\n- .gitignore (new)","status":"closed","priority":1,"issue_type":"task","owner":"shout@ozten.com","created_at":"2026-02-24T18:41:38.783272114Z","created_by":"Austin King","updated_at":"2026-02-24T18:50:49.628459977Z","closed_at":"2026-02-24T18:50:49.628459977Z","close_reason":"single-agent direct commit"}
{"id":"imagen-l17","title":"Add pre-satisfied fast path step to Execution Protocol","description":"Agents waste turns reading and exploring when bead is already done. Need explicit documented fast path to jump from claim to verify.","design":"Edit PROMPT.md: After step 2 (Understand) in Execution Protocol, add step 2b: Pre-satisfied check. If all acceptance criteria appear already met by prior sessions work, take the PRE-SATISFIED PATH: do NOT read source files, do NOT write code, skip step 3 entirely and jump to step 4a (Verify section).","status":"open","priority":1,"issue_type":"task","owner":"shout@ozten.com","created_at":"2026-02-24T19:01:07.089091142Z","created_by":"Austin King","updated_at":"2026-02-24T19:01:07.089091142Z"}
{"id":"imagen-lbg","title":"Include actual error text in failed-attempt notes","description":"Apply improvement R6: update PROMPT.md failed-attempt note format to include actual error text for better future-session diagnosis","design":"Edit PROMPT.md: In '### Marking a Failed Attempt', change the bd update example to show: '--notes=\"[FAILED-ATTEMPT] \u003cYYYY-MM-DD\u003e \u003creason\u003e: \u003cfirst 2 lines of the actual error\u003e\"'","status":"open","priority":1,"issue_type":"task","owner":"shout@ozten.com","created_at":"2026-02-24T19:14:54.931050226Z","created_by":"Austin King","updated_at":"2026-02-24T19:14:54.931050226Z"}
{"id":"imagen-lko","title":"Create curl-installable install.sh script","description":"Create scripts/install.sh adapted from ../blacksmith/scripts/install.sh. Changes from blacksmith:\n- REPO=\"ozten/blacksmith\" -\u003e REPO=\"ozten/imagen\"\n- BLACKSMITH_VERSION env var -\u003e IMAGEN_VERSION\n- Remove dual binary handling (only \"imagen\", no \"-ui\")\n- Archive naming: imagen_{version}_{platform}.tar.gz\n\nKeep from blacksmith: platform detection (linux_amd64, linux_arm64, darwin_amd64, darwin_arm64), smart install dir (/usr/local/bin -\u003e fallback ~/.local/bin), macOS code-signing, curl/wget fallback.\n\n## Acceptance Criteria\n- [ ] scripts/install.sh exists and is executable\n- [ ] Script detects platform correctly (linux/darwin, amd64/arm64)\n- [ ] Script downloads from https://github.com/ozten/imagen/releases\n- [ ] IMAGEN_VERSION env var allows pinning a specific version\n- [ ] Fallback install to ~/.local/bin if /usr/local/bin is not writable\n- [ ] cargo check passes with no new errors\n- [ ] cargo test passes (all existing tests)\n\n## Verify\n- Run: bash -n scripts/install.sh\n- Expect: No syntax errors. Manual test: curl -fsSL .../install.sh | bash installs the binary\n\n## Affected files\n- scripts/install.sh (new — adapted from ../blacksmith/scripts/install.sh)","status":"open","priority":2,"issue_type":"task","owner":"shout@ozten.com","created_at":"2026-02-24T18:41:23.034875447Z","created_by":"Austin King","updated_at":"2026-02-24T18:46:39.010739058Z","dependencies":[{"issue_id":"imagen-lko","depends_on_id":"imagen-jdc","type":"blocks","created_at":"2026-02-24T18:43:58.037166741Z","created_by":"Austin King"}]}
{"id":"imagen-sxh","title":"Add integration tests using cassette replay","description":"Add integration tests that exercise the full CLI flow using cassette replay. CRITICAL: No test may ever hit a live API endpoint. All integration tests use IMAGEN_REPLAY with pre-recorded cassettes from test_fixtures/. Tests go in tests/cli.rs (CLI arg validation, no network) and tests/record_replay.rs (full cassette round-trip).\n\nTest scenarios from PRD:\n1. Gemini happy path: replay Gemini cassette, verify image file output\n2. OpenAI happy path: replay OpenAI cassette, verify image file output\n3. CLI arg validation: invalid model, invalid aspect ratio, missing prompt\n4. Format conversion: --format png with Gemini cassette converts JPEG to PNG\n5. Auto-filename: verify kebab-case naming with timestamp\n\n## Acceptance Criteria\n- [ ] tests/cli.rs has CLI arg parsing and validation tests (no network)\n- [ ] tests/record_replay.rs has cassette replay integration tests\n- [ ] All tests pass with NO API keys set (using IMAGEN_REPLAY)\n- [ ] At least 5 integration test cases covering the scenarios listed above\n- [ ] cargo check passes with no new errors\n- [ ] cargo test passes (all existing + new tests)\n\n## Verify\n- Run: unset GEMINI_API_KEY \u0026\u0026 unset OPENAI_API_KEY \u0026\u0026 cargo test --all-targets\n- Expect: All tests pass with zero network calls\n\n## Affected files\n- tests/cli.rs (new)\n- tests/record_replay.rs (new)","status":"open","priority":2,"issue_type":"task","owner":"shout@ozten.com","created_at":"2026-02-24T18:41:16.569889988Z","created_by":"Austin King","updated_at":"2026-02-24T18:46:39.009205057Z","dependencies":[{"issue_id":"imagen-sxh","depends_on_id":"imagen-6jy","type":"blocks","created_at":"2026-02-24T18:43:57.962749036Z","created_by":"Austin King"}]}
{"id":"imagen-u0k","title":"Handle missing MEMORY.md in Context Loading step","description":"Process improvement to prevent wasted turns when MEMORY.md does not exist. Agents currently try to read MEMORY.md, get a file-not-found error, then fall back to ls exploration, wasting 2 turns per session in early-stage projects.","design":"Edit PROMPT.md: In ## Context Loading section, add after 'The project architecture is documented in MEMORY.md — do NOT re-explore the codebase.': '(If MEMORY.md does not exist, skip it — do NOT fall back to ls, explore agents, or re-reading known files. Proceed directly to step 1.)'","status":"open","priority":1,"issue_type":"task","owner":"shout@ozten.com","created_at":"2026-02-24T19:05:43.616601689Z","created_by":"Austin King","updated_at":"2026-02-24T19:05:43.616601689Z"}
{"id":"imagen-vux","title":"Wire ServiceContext live mode to dispatch to correct adapter","description":"Wire ServiceContext::live() to construct the correct live adapter (GeminiAdapter or OpenAiAdapter) based on the detected Provider enum. The context.rs file already has live(), recording(), and replaying() constructors scaffolded. Ensure live() reads the API key from Config, creates the appropriate adapter, and boxes it as a dyn ImageGenerator. The main.rs run() function already calls ServiceContext methods — this bead makes them actually work with real adapters.\n\n## Acceptance Criteria\n- [x] ServiceContext::live(Provider::Gemini, \u0026config) creates a GeminiAdapter with the Gemini API key\n- [x] ServiceContext::live(Provider::OpenAi, \u0026config) creates an OpenAiAdapter with the OpenAI API key\n- [x] Missing API key for the selected provider returns ImageError::MissingApiKey\n- [x] Full CLI flow works: cargo run -- \"a cat\" (with API key set) generates and saves an image\n- [x] cargo check passes with no new errors\n- [x] cargo test passes (all existing tests)\n\n## Verify\n- Run: cargo check --release\n- Expect: Finished with no errors\n\n## Affected files\n- src/context.rs (modified)\n- src/main.rs (modified — if any wiring adjustments needed)","notes":"## Verify\n- Run: cargo check --release\n- Expect: No errors or warnings","status":"closed","priority":1,"issue_type":"feature","owner":"shout@ozten.com","created_at":"2026-02-24T18:41:03.45177579Z","created_by":"Austin King","updated_at":"2026-02-24T18:55:51.479372504Z","closed_at":"2026-02-24T18:55:51.479372504Z","close_reason":"single-agent direct commit","dependencies":[{"issue_id":"imagen-vux","depends_on_id":"imagen-b7n","type":"blocks","created_at":"2026-02-24T18:43:57.820024087Z","created_by":"Austin King"},{"issue_id":"imagen-vux","depends_on_id":"imagen-xjv","type":"blocks","created_at":"2026-02-24T18:43:57.843883099Z","created_by":"Austin King"}]}
{"id":"imagen-xjv","title":"Wire OpenAI live adapter to make real API calls","description":"Complete the OpenAI live adapter so it makes real API calls. The skeleton exists at src/adapters/live/openai.rs with the struct and trait impl stubbed out. Wire it to POST to https://api.openai.com/v1/images/generations with Bearer token auth. Use aspect_ratio_to_openai_size() from params.rs to translate aspect ratios to pixel dimensions. Parse data[].b64_json for base64 image data. OpenAI only accepts sizes: 1024x1024, 1536x1024, 1024x1536, auto. For 2K/4K size requests, use \"auto\" and log a note in verbose mode. See PRD \"Parameter Translation\" and \"External References\" sections.\n\n## Acceptance Criteria\n- [ ] OpenAiAdapter::generate() sends correct HTTP POST with model, prompt, size (translated from aspect_ratio), quality, output_format, and n fields\n- [ ] Size translation uses aspect_ratio_to_openai_size() for 1K; uses \"auto\" for 2K/4K\n- [ ] Response parsing extracts base64 image data from data[].b64_json\n- [ ] API key is read from Config::openai_key() (env var \u003e config file)\n- [ ] Missing API key returns ImageError::MissingApiKey\n- [ ] HTTP errors return ImageError::Api with status code and message\n- [ ] cargo check passes with no new errors\n- [ ] cargo test passes (all existing tests)\n\n## Verify\n- Run: OPENAI_API_KEY=test cargo check\n- Expect: Compiles without errors. Manual live test: OPENAI_API_KEY=\u003creal-key\u003e cargo run -- -m gpt-1 \"a cat\"\n\n## Affected files\n- src/adapters/live/openai.rs (modified)","status":"closed","priority":1,"issue_type":"feature","owner":"shout@ozten.com","created_at":"2026-02-24T18:41:00.134233728Z","created_by":"Austin King","updated_at":"2026-02-24T18:52:54.242406361Z","closed_at":"2026-02-24T18:52:54.242406361Z","close_reason":"single-agent direct commit","dependencies":[{"issue_id":"imagen-xjv","depends_on_id":"imagen-jdc","type":"blocks","created_at":"2026-02-24T18:43:57.793741698Z","created_by":"Austin King"}]}
